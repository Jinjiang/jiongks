<!DOCTYPE html>
<html>

<head>
  <!-- proud for contributing Vue.js -->
  <meta charset="utf-8">
  <meta name="format-detection" content="telephone=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-touch-fullscreen" content="yes" />

  
  <title>
    
    IndexedDBæŠ€æœ¯ç®€ä»‹(å››) -
    
    å›§å…‹æ–¯
  </title>

  
<link rel="stylesheet" href="/css/pure.css">

  
<link rel="stylesheet" href="/css/style.css">


  
  <link rel="alternate" href="/atom.xml" title="å›§å…‹æ–¯" type="application/atom+xml">
  
  
  <link rel="icon" href="/favicon.ico">
  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <script>(() => { if ((new Date().getHours() + 6) % 24 < 12) document.body.classList.add('dark-mode') })()</script>

  <div class="dark-mode-helper"></div>

  <div id="wrapper">

    <div id="header">
      <h1>
        <a href="/" title="å›§å…‹æ–¯">
          å›§å…‹æ–¯
        </a>
      </h1>
      <p class="description">
        è¿™é‡Œæ˜¯å‹¾ä¸‰è‚¡å››çš„å®¶
      </p>
    </div>

    <div id="nav" class="pure-menu pure-menu-open pure-menu-horizontal">
      <ul>
        
        <li>
          <a href="/all-demos/">
            çº¿ä¸Š
          </a>
        </li>
        
        <li>
          <a href="/all-slides/">
            çº¿ä¸‹
          </a>
        </li>
        
        <li>
          <a href="/about/">
            å…³äº
          </a>
        </li>
        
        <li><a href="/archives">å½’æ¡£</li>
      </ul>
    </div>

    <div id="main"><div class="content">
  <h2>
    IndexedDBæŠ€æœ¯ç®€ä»‹(å››)
  </h2>
  
<p><mark>æœ¬æ–‡æ‘˜è‡ª å‹¾ä¸‰è‚¡å›› æ›´æ—©æ—¶æœŸçš„ <a target="_blank" rel="noopener" href="http://bulaoge.net/?g3g4">ä¸è€æ­Œ</a> åšå®¢ã€‚</mark></p>

<a id="more"></a>
<p>è¿™ç¯‡æ–‡ç« ä¼šæ¥ç€ä»‹ç»IndexedDB(ä»¥ä¸‹ç®€ç§°IDB)ã€‚æˆ‘ä»¬ä¼šä»‹ç»å¦‚ä½•è§£å†³åœ¨webkitå†…æ ¸ä¸‹ã€æ–°æ—§ç‰ˆæœ¬è§„èŒƒçš„å…¼å®¹é—®é¢˜ã€‚<br />
<br />
ç›®å‰æ”¯æŒIDBçš„webkitå†…æ ¸æµè§ˆå™¨æœ‰chromeå’Œå‚²æ¸¸3ï¼Œsafariæš‚ä¸æ”¯æŒIDBã€‚<br />
<br />
é¦–å…ˆï¼Œç”±äºå†…æ ¸ä¸åŒï¼Œæ‰€ä»¥<code>window.indexedDB</code>è¢«æ”¹ä¸ºäº†å¸¦æœ‰<code>webkit</code>å‰ç¼€çš„å˜é‡window.webkitIndexedDBã€‚åŒæ—¶å‘ç”Ÿå˜åŒ–çš„è¿˜æœ‰ä¸¤ä¸ªå¯¹è±¡<code>IDBKeyRange</code>å’Œ<code>IDBTransaction</code>ã€‚å¦‚æœæƒ³å…¼å®¹geckoå’Œwebkitå†…æ ¸ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ç¨‹åºçš„å¼€å¤´åŠ å…¥å¦‚ä¸‹ä»£ç ï¼š<br />
<pre>if ('webkitIndexedDB' in window) {<br>    window.indexedDB = webkitIndexedDB;<br>    window.IDBKeyRange = webkitIDBKeyRange;<br>    window.IDBTransaction = window.webkitIDBTransaction;<br>}<br>else if ('mozIndexedDB' in window) {<br>    window.indexedDB = mozIndexedDB;<br>}</pre><br />
å…¶æ¬¡ï¼Œwebkitå†…æ ¸(chrome17æˆ–å‚²æ¸¸3.3)å’ŒFirefox9åŠå…¶æ›´æ—§çš„ç‰ˆæœ¬éµå¾ªçš„IDBè§„èŒƒå·²ç»æ˜¯æ—§ç‰ˆæœ¬çš„è§„èŒƒäº†ï¼Œè€ŒFirefox10å·²ç»éµå¾ªçš„æ˜¯æ–°ç‰ˆæœ¬IDBè§„èŒƒã€‚ä¸¤è€…çš„ä¸»è¦åŒºåˆ«åœ¨äºç‰ˆæœ¬æ§åˆ¶çš„æ–¹å¼ä¸åŒã€‚æ—§ç‰ˆä¸­çš„ç‰ˆæœ¬å˜æ›´æ–¹å¼æ˜¯ï¼š<br />
<pre>var req = window.indexedDB.open(dbName); // æ—§ç‰ˆåœ¨è¿™é‡Œä¸éœ€è¦å†™æ˜dbVersion<br>req.onsuccess = function (e) {<br>    var db = this.result;<br>    if (db.version != '1.0') {<br>        var subReq = db.setVersion('1.0'); // é€šè¿‡setVersionä¿®æ”¹ç‰ˆæœ¬å·ï¼Œè€Œä¸æ˜¯onupgradeneededäº‹ä»¶<br>        subReq.onsuccess = function (e) {<br>            // TODO: real success code<br>        };<br>    }<br>    else {<br>        // TODO: real success code<br>    }<br>};</pre><br />
é™¤äº†ä¸Šè¿°çš„ä¸¤ç‚¹ä¸åŒï¼Œæ–°æ—§ä¸¤ç‰ˆçš„æ¥å£è®¾è®¡åŸºæœ¬ä¸Šæ˜¯ç›¸åŒçš„ã€‚<br />
è§„èŒƒçš„é¢‘ç¹å˜æ›´ç¡®å®ä¸æ˜¯æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°çš„ï¼Œåœ¨IDBå°šæœªè¢«å¹¿æ³›åº”ç”¨æ—¶åšå‡ºæ”¹å˜ï¼Œæˆ–è®¸å½±å“é¢è¿˜ä¸ç®—å¤ªå¤§ã€‚ä½†å¦‚æœæˆ‘ä»¬å¸Œæœ›é€šè¿‡ä¸€å¥—ä»£ç å…¼å®¹æ–°æ—§ä¸¤ç‰ˆè§„èŒƒï¼Œè¿˜æ˜¯æœ‰åŠæ³•çš„ã€‚<br />
<pre>var req = window.indexedDB.open(dbName, dbVersion); // å¯¹äºæ—§ç‰ˆè€Œè¨€ï¼Œä¼šå¿½ç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œå› æ­¤è¿™é‡Œå¯ä»¥å…¼å®¹<br>req.onsuccess = function (e) {<br>    var db = this.result;<br>    if (db.version != dbVersion) { // æ–°ç‰ˆä¸­ä¸¤è€…ç»å¯¹ä¸€è‡´ï¼Œå¦åˆ™åªä¼šè§¦å‘onupgradeneededäº‹ä»¶ï¼Œå› æ­¤è¿™é‡Œä¹Ÿå¯ä»¥å…¼å®¹<br>        // TODO: code of changing object stores for new version<br>        var subReq = db.setVersion(dbVersion);<br>        subReq.onsuccess = function (e) {<br>            // TODO: real success code<br>        };<br>    }<br>    else {<br>        // TODO: real success code<br>    }<br>};<br>req.onupgradeneeded = function (e) {<br>    // TODO: code of changing object stores for new version<br>};</pre><br />
<br />
---------------- å…¼å®¹IEçš„åˆ†å‰²çº¿ ---------------<br />
<br />
è¿™é‡Œé¢å¤–æ’å…¥ä¸€æ®µå¦‚ä½•å…¼å®¹IE10çš„è¯´æ˜ï¼ŒIE10æœ€æ–°çš„é¢„è§ˆç‰ˆä¹Ÿå·²ç»æ”¯æŒäº†IndexedDBï¼Œå’Œ<code>window.webkitIndexedDB</code>å’Œ<code>window.mozIndexedDB</code>ç±»ä¼¼ï¼ŒIE10ä¸­å¯¹åº”çš„å˜é‡åä¸º<code>window.msIndexedDB</code>ï¼Œæ‰€ä»¥ï¼Œç›¸å…¼å®¹IEï¼ŒæŠŠä¸Šé¢ç¬¬ä¸€éƒ¨åˆ†çš„ä»£ç æ”¹ä¸ºï¼š<pre>if ('webkitIndexedDB' in window) {<br>    window.indexedDB = webkitIndexedDB;<br>    window.IDBKeyRange = webkitIDBKeyRange;<br>    window.IDBTransaction = window.webkitIDBTransaction;<br>}<br>else if ('mozIndexedDB' in window) {<br>    window.indexedDB = mozIndexedDB;<br>}<br>else if ('msIndexedDB' in window) {<br>    window.indexedDB = msIndexedDB;<br>}</pre>å³å¯ã€‚ä¸‹é¢çš„â€œå…¨å…¼å®¹â€çš„ä¾‹å­å·²ç»ç”¨åˆ°äº†è¿™æ®µä»£ç ã€‚<br />
<br />
---------------- å…¼å®¹IEçš„åˆ†å‰²çº¿ ---------------<br />
<br />
è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ä¸åŒå†…æ ¸ä¸åŒç‰ˆæœ¬ä¸‹çš„â€œå…¨å…¼å®¹â€ã€‚<br />
è¿˜è®°å¾—<a href="http://jinjiang.github.com/demos/indexed-db/firefox-10.html" target="_blank">ä¸Šä¸€ç¯‡æ–‡ç« ä¸­çš„demo</a>å—ï¼Ÿæˆ‘é€šè¿‡ä¸Šé¢çš„å…¼å®¹æ–¹æ³•ï¼Œå¯¹è¿™ä¸ªä¾‹å­åšäº†è¿›ä¸€æ­¥çš„å…¼å®¹æ€§å¤„ç†å’Œæ¥å£å°è£…ï¼Œå¾—åˆ°äº†å¦ä¸€ä¸ªdemoï¼š<br />
<br />
<a href="http://jinjiang.github.com/demos/indexed-db/" target="_blank">DEMOæ¼”ç¤ºé“¾æ¥</a> (firefox/chrome/maxthon)<br />
<br />
è‡³æ­¤ï¼ŒIndexedDBæŠ€æœ¯ä»‹ç»å‘Šä¸€æ®µè½ã€‚æˆ‘ä»¬å…ˆåä»‹ç»äº†<a href="http://bulaoge.net/topic.blg?dmn=g3g4&tid=2329796" target="_blank">åŸºæœ¬åŸç†</a>ã€<a href="http://bulaoge.net/topic.blg?dmn=g3g4&tid=2330716" target="_blank">æ¥å£å®šä¹‰</a>ã€å¹¶<a href="http://bulaoge.net/topic.blg?dmn=g3g4&tid=2335030" target="_blank">é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­</a>ï¼Œè¿›è¡Œäº†gecko/webkitå†…æ ¸ä¸‹çš„æ–°æ—§è§„èŒƒçš„å…¼å®¹å’Œé€‚é…ï¼Œå¸Œæœ›è¯¸ä½çœ‹è¿‡ä¹‹åæœ‰æ‰€æ”¶è·ã€‚IndexedDBçš„ç”¨é€”å’Œç”¨æ³•è¿˜æœ‰å¾ˆå¤šï¼Œåœ¨æ­¤ä¸ä¸€ä¸€åˆ—ä¸¾ï¼Œå¤§å®¶å¯ä»¥åœ¨<a href="http://www.w3.org/TR/IndexedDB/" target="_blank">W3Cçš„å®˜æ–¹æ–‡æ¡£</a>ä¸­ç»§ç»­ç ”ç©¶å’Œæ¢ç´¢ã€‚<br />
<br />
å®Œ</p>

</div>

<p align="right">
  <small>
    <a href="https://github.com/Jinjiang/jinjiang.github.io/edit/dev/source/_posts/2012-02-14.md" target="_blank">
      å‘æœ¬æ–‡æå‡ºä¿®æ”¹æˆ–å‹˜è¯¯å»ºè®®
    </a>
  </small>
</p>




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>
  const gitalk = new Gitalk({
    clientID: 'c99e23053fc1bba6a58c',
    clientSecret: '64efe1cd1438e77ae2bf8eba92b51c90d0cc2b9f',
    repo: 'jinjiang.github.io',
    owner: 'jinjiang',
    admin: ['jinjiang'],
    id: location.pathname,      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')
</script>
</div>

    <div id="footer">
      <a href="/">å›§å…‹æ–¯</a>
      
      |
      <a href="/atom.xml" title="rss_feed">RSS</a>
      
      |
      æˆ‘æ˜¯ç™¾åº¦ç»Ÿè®¡
      <script src="https://hm.baidu.com/h.js?a0a2372d4b7621d0bfe71f33c58a4bd8"></script>
      |
      æˆ‘ä¼šç¿»è„¸ <a href="#" onclick="document.body.classList.toggle('dark-mode'), event.preventDefault()" style="font-size: 1.25em;">ğŸŒšğŸŒ</a>
    </div>
  </div>

  
<script src="/js/script.js"></script>

</body>

</html>
