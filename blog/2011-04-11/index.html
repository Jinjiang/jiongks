<!DOCTYPE html>
<html>

<head>
  <!-- proud for contributing Vue.js -->
  <meta charset="utf-8">
  <meta name="format-detection" content="telephone=no" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-touch-fullscreen" content="yes" />

  
  <title>
    
    重装系统或MySQL程序之后，如何恢复使用旧文件数据 -
    
    囧克斯
  </title>

  
<link rel="stylesheet" href="/css/pure.css">

  
<link rel="stylesheet" href="/css/style.css">


  
  <link rel="alternate" href="/atom.xml" title="囧克斯" type="application/atom+xml">
  
  
  <link rel="icon" href="/favicon.ico">
  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <script>(() => { if ((new Date().getHours() + 6) % 24 < 12) document.body.classList.add('dark-mode') })()</script>

  <div class="dark-mode-helper"></div>

  <div id="wrapper">

    <div id="header">
      <h1>
        <a href="/" title="囧克斯">
          囧克斯
        </a>
      </h1>
      <p class="description">
        这里是勾三股四的家
      </p>
    </div>

    <div id="nav" class="pure-menu pure-menu-open pure-menu-horizontal">
      <ul>
        
        <li>
          <a href="/all-demos/">
            线上
          </a>
        </li>
        
        <li>
          <a href="/all-slides/">
            线下
          </a>
        </li>
        
        <li>
          <a href="/about/">
            关于
          </a>
        </li>
        
        <li><a href="/archives">归档</li>
      </ul>
    </div>

    <div id="main"><div class="content">
  <h2>
    重装系统或MySQL程序之后，如何恢复使用旧文件数据
  </h2>
  
<p><mark>本文摘自 勾三股四 更早时期的 <a target="_blank" rel="noopener" href="http://bulaoge.net/?g3g4">不老歌</a> 博客。</mark></p>

<a id="more"></a>
<p>今天办公室的私人数据库出了点小问题，对mysql进行了重装，但由于疏忽了部分配置信息，导致旧数据没有办法继续使用了，MySQL数据库服务无法启动。险些及时找到了问题所在，虚惊一场。事后觉得这类问题还是很容易遇到的，所以打算写个简单的备忘。<br />
<br />
我的mysql是在windows下，用msi安装包直接安装的，我们经常会自定义或配置的信息有这么几个：<br />
1. 程序目录<br />
2. Server Datafiles 目录<br />
3. InnoDB Tablespace 目录<br />
4. 默认编码<br />
5. 管理员密码<br />
6. 各种封闭性选项(多为三选一或二选一)<br />
<br />
对于6，估计相同的人安装会选择相同的选项，出错的几率应该不大<br />
对于5，是比较有特征的信息且是一定需要设置的，出错的几率也不大<br />
对于1，这个目标太过明显了，估计大家也不会装错，就算装错应该很快反映的过来吧……<br />
<br />
那就剩下2、3和4了<br />
<br />
我个人习惯，会把4设为utf-8（默认值不是这个，貌似是latin1）<br />
另外2和3那两个目录很重要，一定要设置得和你的数据所在的目录相吻合，才可以正常工作。两者的设置时机不尽相同，前者在设置安装程序目录时一并设置，后者在安装完成后的初始化配置向导中进行设置。<br />
<br />
这次虚惊一场，就是因为重装MySQL之后Server Datafiles目录忘记设置了，结果默认的安装目录里的数据是空白的，和InnoDB Tablespace目录信息无法匹配。导致1076错误，同时MySQL无法启动。<br />
<br />
最后，提供一个最可靠的办法，就是寻找my.ini文件。不同版本的MySQL，它的my.ini文件可能在程序目录中，也可能在个人文件夹中或windows文件夹中，如果找不到，可以在本地硬盘里搜索。上述所有的设置项基本都可以在这个ini文件中找到。可以通过这个文件确认修改结果。</p>

</div>

<p align="right">
  <small>
    <a href="https://github.com/Jinjiang/jinjiang.github.io/edit/dev/source/_posts/2011-04-11.md" target="_blank">
      向本文提出修改或勘误建议
    </a>
  </small>
</p>




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>
  const gitalk = new Gitalk({
    clientID: 'c99e23053fc1bba6a58c',
    clientSecret: '64efe1cd1438e77ae2bf8eba92b51c90d0cc2b9f',
    repo: 'jinjiang.github.io',
    owner: 'jinjiang',
    admin: ['jinjiang'],
    id: location.pathname,      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')
</script>
</div>

    <div id="footer">
      <a href="/">囧克斯</a>
      
      |
      <a href="/atom.xml" title="rss_feed">RSS</a>
      
      |
      我是百度统计
      <script src="https://hm.baidu.com/h.js?a0a2372d4b7621d0bfe71f33c58a4bd8"></script>
      |
      我会翻脸 <a href="#" onclick="document.body.classList.toggle('dark-mode'), event.preventDefault()" style="font-size: 1.25em;">🌚🌝</a>
    </div>
  </div>

  
<script src="/js/script.js"></script>

</body>

</html>
